/**
*
*   Simple .ini Parser for JavaScript/Node
*
*   @author Nikos M.  
*   https://foo123.github.com/
*   http://nikos-web-development.netai.net/
*
**/
(function(t,e){var r=require?require("fs"):null,n=[";","#"],i=/\n\r|\r\n|\r|\n/g,l=Object.prototype.hasOwnProperty,_=Object.keys,s=Object.prototype.toString,o=function(t){return t&&"[object Object]"==s.call(t)},u=function(t){return t&&"[object Array]"==s.call(t)},f=function(t){return!t||"object"==typeof t&&!_(t).length},c=function(t){return t.replace(/^\s+/g,"").replace(/\s+$/g,"")},p=function(t){return f(t)?[]:_(t)},a=function(t,e,r,n,i){var _,s,c,d,b,g,h,y="";if(!f(t))for(s=e?[e]:p(t),h=s.length,g=0;h>g;g++)if(_=s[g],l.call(t,_)&&(c=t[_],!f(c))){if(y+=r+"["+_+"]"+i,c.__list__&&u(c.__list__)&&!f(c.__list__)&&(y+=n+c.__list__.join(n+i+n)+n+i,delete c.__list__),!f(c))for(d in c)l.call(c,d)&&(b=c[d],b&&(y+=o(b)||u(b)?a(c,d,r+"["+_+"]",n,i):n+d+n+"="+n+b+n+i));y+=i}return y},d=self={fromString:function(t,r,l){var _,s,o,u,f,p,a,d,b,g,h,y,O,j,x={};for(r=e===r?!0:r,f=l&&l.length?""+l:"_",x[f]=r?{__list__:[]}:{},p=x,t=""+t,_=t.split(i),o=_.length,u=0;o>u;++u)if(s=c(_[u]),a=s.substr(0,1),!(0>=s.length||n.indexOf(a)>-1))if("["!=a)'"'!=a&&"'"!=a?(d=s.split("=",2),d.length<2?(b=c(d[0]),r?p[f].__list__.push(b):p[f][b]=!0):(b=c(d[0]),g=c(d[1]),p[f][b]=g)):(y=s.indexOf(a,1),b=s.substr(1,y-1),s=c(s.substr(y)),s.indexOf("=",0)>-1?(g=c(s.split("=",2)[1]),h=g.substr(0,1),('"'==h||"'"==h)&&(y=g.indexOf(h,1),g=g.substr(1,y-1)),p[f][b]=g):r?p[f].__list__.push(b):p[f][b]=!0);else for(j=!0;"["==a;)p=j?x:p[f],j=!1,O=s.indexOf("]",1),f=s.substr(1,O-1),p[f]||(p[f]=r?{__list__:[]}:{}),s=c(s.substr(O+1)),a=s.substr(0,1);return x},fromFile:function(t,e,n){return r?self.fromString(r.readFileSync(t,e,n)):""},toString:function(t,r,n,i){var _,s,o,c,p="",d=r?""+r:"_",b=e!==n&&n?'"':"";if(i=i||"\n",!f(t[d])){_=t[d],s=null,_.__list__&&(s=_.__list__,s&&u(s)&&!f(s)&&(p+=b+s.join(b+i+b)+b+i,delete _.__list__));for(o in _)l.call(_,o)&&(c=_[o],f(c)||(p+=b+o+b+"="+b+c+b+i));p+=i,delete t[d]}return p+=a(t,null,"",b,i)},toFile:function(t,e,n,i,l){return r?r.writeFileSync(t,self.toString(e,n,i,l)):!1}};"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof exports?exports=d:this.IniParser=d}).call(this);