/**
*
*   Simple .ini Parser for JavaScript/Node
*
*   @author Nikos M.  
*   https://foo123.github.com/
*   http://nikos-web-development.netai.net/
*
**/
(function(t,e){var n=require?require("fs"):null,r=[";","#"],i=/\n\r|\r\n|\r|\n/g,l=Object.prototype.hasOwnProperty,_=Object.keys,o=Object.prototype.toString,s=function(t){return t&&"[object Object]"==o.call(t)},f=function(t){return t&&"[object Array]"==o.call(t)},u=function(t){return!t||"object"==typeof t&&!_(t).length},c=function(t){return t.replace(/^\s+/g,"").replace(/\s+$/g,"")},p=function(t){return u(t)?[]:_(t)},a=function(t,e){var n=t.indexOf(e,1),r=t.substr(1,n-1),i=c(t.substr(n));return[r,i]},d=function(t,e,n,r,i){var _,o,c,a,g,h,b,y="";if(!u(t))for(o=e?[e]:p(t),b=o.length,h=0;b>h;h++)if(_=o[h],l.call(t,_)&&(c=t[_],!u(c))){if(y+=n+"["+_+"]"+i,c.__list__&&f(c.__list__)&&!u(c.__list__)&&(y+=r+c.__list__.join(r+i+r)+r+i,delete c.__list__),!u(c))for(a in c)l.call(c,a)&&(g=c[a],g&&(y+=s(g)||f(g)?d(c,a,n+"["+_+"]",r,i):r+a+r+"="+r+g+r+i));y+=i}return y},g=self={fromString:function(t,n,l){var _,o,s,f,u,p,d,g,h,b,y,j,O,x,S={};for(n=e===n?!0:n,u=l&&l.length?""+l:"_",S[u]=n?{__list__:[]}:{},p=S,t=""+t,_=t.split(i),s=_.length,f=0;s>f;++f)if(o=c(_[f]),!(0>=o.length||r.indexOf(o[0])>-1))if(d=o[0],"["==d)for(O=!0;"["==d&&(p=O?S:p[u],O=!1,j=o.indexOf("]",1),u=o.substr(1,j-1),p[u]||(p[u]=n?{__list__:[]}:{}),o=c(o.substr(j+1)),o.length);)d=o[0];else'"'==d||"'"==d?(x=a(o,d),h=x[0],o=x[1],o.indexOf("=")>-1?(b=c(o.split("=",2)[1]),y=b[0],('"'==y||"'"==y)&&(x=a(b,y),b=x[0]),p[u][h]=b):n?p[u].__list__.push(h):p[u][h]=!0):(g=o.split("=",2),g.length<2?(h=c(g[0]),n?p[u].__list__.push(h):p[u][h]=!0):(h=c(g[0]),b=c(g[1]),y=b[0],('"'==y||"'"==y)&&(x=a(b,y),b=x[0]),p[u][h]=b));return S},fromFile:function(t,e,r){return n?self.fromString(n.readFileSync(t,e,r)):""},toString:function(t,n,r,i){var _,o,s,c,p="",a=n?""+n:"_",g=e!==r&&r?'"':"";if(i=i||"\n",!u(t[a])){_=t[a],o=null,_.__list__&&(o=_.__list__,o&&f(o)&&!u(o)&&(p+=g+o.join(g+i+g)+g+i,delete _.__list__));for(s in _)l.call(_,s)&&(c=_[s],u(c)||(p+=g+s+g+"="+g+c+g+i));p+=i,delete t[a]}return p+=d(t,null,"",g,i)},toFile:function(t,e,r,i,l){return n?n.writeFileSync(t,self.toString(e,r,i,l)):!1}};"undefined"!=typeof module&&module.exports?module.exports=g:"undefined"!=typeof exports?exports=g:this.IniParser=g}).call(this);